<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Migrate_parsetree_driver (ocaml-migrate-parsetree.Migrate_parsetree_driver)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../index.html">ocaml-migrate-parsetree</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Migrate_parsetree_driver</span></h1></header><h2>State a rewriter can access</h2><div class="spec type" id="type-extra"><a href="#type-extra" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>extra</code><code></code><code><span class="keyword"> = </span></code><code><span class="keyword">..</span></code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-config"><a href="#type-config" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>config</code><code></code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-config.tool_name" class="anchored"><td class="def field"><a href="#type-config.tool_name" class="anchor"></a><code>tool_name : string;</code></td></tr><tr id="type-config.include_dirs" class="anchored"><td class="def field"><a href="#type-config.include_dirs" class="anchor"></a><code>include_dirs : string list;</code></td></tr><tr id="type-config.load_path" class="anchored"><td class="def field"><a href="#type-config.load_path" class="anchor"></a><code>load_path : string list;</code></td></tr><tr id="type-config.debug" class="anchored"><td class="def field"><a href="#type-config.debug" class="anchor"></a><code>debug : bool;</code></td></tr><tr id="type-config.for_package" class="anchored"><td class="def field"><a href="#type-config.for_package" class="anchor"></a><code>for_package : string option;</code></td><td class="doc"><p>(** Additional parameters that can be passed by a caller of
<code class="code">rewrite_{signature,structure}</code> to a specific register rewriter. *)</p></td></tr><tr id="type-config.extras" class="anchored"><td class="def field"><a href="#type-config.extras" class="anchor"></a><code>extras : <a href="index.html#type-extra">extra</a> list;</code></td></tr></table><code>}</code><code></code></div><div class="doc"></div></div><div class="spec val" id="val-make_config"><a href="#val-make_config" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>make_config : tool_name:string <span class="keyword">&#8209;&gt;</span> ?&#8288;include_dirs:string list <span class="keyword">&#8209;&gt;</span> ?&#8288;load_path:string list <span class="keyword">&#8209;&gt;</span> ?&#8288;debug:bool <span class="keyword">&#8209;&gt;</span> ?&#8288;for_package:string <span class="keyword">&#8209;&gt;</span> ?&#8288;extras:<a href="index.html#type-extra">extra</a> list <span class="keyword">&#8209;&gt;</span> unit <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-config">config</a></code></div><div class="doc"></div></div><div class="spec type" id="type-cookies"><a href="#type-cookies" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>cookies</code><code></code><code></code></div><div class="doc"></div></div><div class="spec val" id="val-get_cookie"><a href="#val-get_cookie" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get_cookie : <a href="index.html#type-cookies">cookies</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> <span class="type-var">'types</span> <a href="../Migrate_parsetree_versions/index.html#type-ocaml_version">Migrate_parsetree_versions.ocaml_version</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'types</span> <a href="../Migrate_parsetree_versions/index.html#type-get_expression">Migrate_parsetree_versions.get_expression</a> option</code></div><div class="doc"></div></div><div class="spec val" id="val-set_cookie"><a href="#val-set_cookie" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>set_cookie : <a href="index.html#type-cookies">cookies</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> <span class="type-var">'types</span> <a href="../Migrate_parsetree_versions/index.html#type-ocaml_version">Migrate_parsetree_versions.ocaml_version</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'types</span> <a href="../Migrate_parsetree_versions/index.html#type-get_expression">Migrate_parsetree_versions.get_expression</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"></div></div><div class="spec val" id="val-set_global_cookie"><a href="#val-set_global_cookie" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>set_global_cookie : string <span class="keyword">&#8209;&gt;</span> <span class="type-var">'types</span> <a href="../Migrate_parsetree_versions/index.html#type-ocaml_version">Migrate_parsetree_versions.ocaml_version</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'types</span> <a href="../Migrate_parsetree_versions/index.html#type-get_expression">Migrate_parsetree_versions.get_expression</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"></div></div><h2>Registering rewriters</h2><div class="spec type" id="type-rewriter"><a href="#type-rewriter" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'types rewriter</code><code><span class="keyword"> = </span><a href="index.html#type-config">config</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-cookies">cookies</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'types</span> <a href="../Migrate_parsetree_versions/index.html#type-get_mapper">Migrate_parsetree_versions.get_mapper</a></code><code></code></div><div class="doc"></div></div><div class="spec val" id="val-register"><a href="#val-register" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>register : name:string <span class="keyword">&#8209;&gt;</span> ?&#8288;reset_args:(unit <span class="keyword">&#8209;&gt;</span> unit) <span class="keyword">&#8209;&gt;</span> ?&#8288;args:(Arg.key<span class="keyword"> * </span>Arg.spec<span class="keyword"> * </span>Arg.doc) list <span class="keyword">&#8209;&gt;</span> ?&#8288;position:int <span class="keyword">&#8209;&gt;</span> <span class="type-var">'types</span> <a href="../Migrate_parsetree_versions/index.html#type-ocaml_version">Migrate_parsetree_versions.ocaml_version</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'types</span> <a href="index.html#type-rewriter">rewriter</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p>Register a ppx rewriter. <code class="code">position</code> is a integer that indicates
when the ppx rewriter should be applied. It is guaranteed that if
two ppx rewriters <code class="code">a</code> and <code class="code">b</code> have different position numbers, then
the one with the lowest number will be applied first. The rewriting
order of ppx rewriters with the same position number is not
specified. The default position is <code class="code">0</code>.</p><p>Note that more different position numbers means more AST
conversions and slower rewriting, so think twice before setting
<code class="code">position</code> to a non-zero number.</p></div></div><div class="spec val" id="val-registered_args"><a href="#val-registered_args" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>registered_args : unit <span class="keyword">&#8209;&gt;</span> (Arg.key<span class="keyword"> * </span>Arg.spec<span class="keyword"> * </span>Arg.doc) list</code></div><div class="doc"><p>Return the list of command line arguments registered by rewriters</p></div></div><div class="spec val" id="val-reset_args"><a href="#val-reset_args" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>reset_args : unit <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p>Call all the registered <code class="code">reset_args</code> callbacks</p></div></div><h2>Running registered rewriters</h2><div class="spec val" id="val-run_as_ast_mapper"><a href="#val-run_as_ast_mapper" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>run_as_ast_mapper : string list <span class="keyword">&#8209;&gt;</span> Ast_mapper.mapper</code></div><div class="doc"></div></div><div class="spec val" id="val-run_as_ppx_rewriter"><a href="#val-run_as_ppx_rewriter" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>run_as_ppx_rewriter : unit <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span></code></div><div class="doc"></div></div><div class="spec val" id="val-run_main"><a href="#val-run_main" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>run_main : unit <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span></code></div><div class="doc"></div></div><h2>Manual mapping</h2><div class="spec type" id="type-some_signature"><a href="#type-some_signature" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>some_signature</code><code></code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-some_signature.Sig" class="anchored"><td class="def constructor"><a href="#type-some_signature.Sig" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Sig</span><span class="keyword"> : </span>(<span class="keyword">module </span><a href="../Migrate_parsetree_versions/module-type-OCaml_version/index.html">Migrate_parsetree_versions.OCaml_version</a> <span class="keyword">with</span> <span class="keyword">type </span><a href="../Migrate_parsetree_versions/module-type-OCaml_version/Ast/Parsetree/index.html#type-signature">Ast.Parsetree.signature</a> <span class="keyword">=</span> <span class="type-var">'concrete</span>)<span class="keyword"> * </span><span class="type-var">'concrete</span> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-some_signature">some_signature</a></code></td></tr></table><code></code></div><div class="doc"></div></div><div class="spec type" id="type-some_structure"><a href="#type-some_structure" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>some_structure</code><code></code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-some_structure.Str" class="anchored"><td class="def constructor"><a href="#type-some_structure.Str" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Str</span><span class="keyword"> : </span>(<span class="keyword">module </span><a href="../Migrate_parsetree_versions/module-type-OCaml_version/index.html">Migrate_parsetree_versions.OCaml_version</a> <span class="keyword">with</span> <span class="keyword">type </span><a href="../Migrate_parsetree_versions/module-type-OCaml_version/Ast/Parsetree/index.html#type-structure">Ast.Parsetree.structure</a> <span class="keyword">=</span> <span class="type-var">'concrete</span>)<span class="keyword"> * </span><span class="type-var">'concrete</span> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-some_structure">some_structure</a></code></td></tr></table><code></code></div><div class="doc"></div></div><div class="spec val" id="val-migrate_some_signature"><a href="#val-migrate_some_signature" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>migrate_some_signature : <span class="type-var">'version</span> <a href="../Migrate_parsetree_versions/index.html#type-ocaml_version">Migrate_parsetree_versions.ocaml_version</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-some_signature">some_signature</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'version</span> <a href="../Migrate_parsetree_versions/index.html#type-get_signature">Migrate_parsetree_versions.get_signature</a></code></div><div class="doc"></div></div><div class="spec val" id="val-migrate_some_structure"><a href="#val-migrate_some_structure" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>migrate_some_structure : <span class="type-var">'version</span> <a href="../Migrate_parsetree_versions/index.html#type-ocaml_version">Migrate_parsetree_versions.ocaml_version</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-some_structure">some_structure</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'version</span> <a href="../Migrate_parsetree_versions/index.html#type-get_structure">Migrate_parsetree_versions.get_structure</a></code></div><div class="doc"></div></div><div class="spec val" id="val-rewrite_signature"><a href="#val-rewrite_signature" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>rewrite_signature : <a href="index.html#type-config">config</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'version</span> <a href="../Migrate_parsetree_versions/index.html#type-ocaml_version">Migrate_parsetree_versions.ocaml_version</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'version</span> <a href="../Migrate_parsetree_versions/index.html#type-get_signature">Migrate_parsetree_versions.get_signature</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-some_signature">some_signature</a></code></div><div class="doc"></div></div><div class="spec val" id="val-rewrite_structure"><a href="#val-rewrite_structure" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>rewrite_structure : <a href="index.html#type-config">config</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'version</span> <a href="../Migrate_parsetree_versions/index.html#type-ocaml_version">Migrate_parsetree_versions.ocaml_version</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'version</span> <a href="../Migrate_parsetree_versions/index.html#type-get_structure">Migrate_parsetree_versions.get_structure</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-some_structure">some_structure</a></code></div><div class="doc"></div></div></body></html>